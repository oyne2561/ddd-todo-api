`docker run` は、Dockerの中で**最も基本的かつ重要なコマンド**です。

一言で言うと、**「設計図（イメージ）から、実体（コンテナ）を作って動かす」** という命令です。

先ほどのコマンドを例に、解剖図のように分解して解説します。

---

### コマンドの解剖図

実行したコマンドはこの構造になっています。

```bash
docker run -p 3000:3000 ddd-todo-api

```

これを3つのパーツに分解します。

1. **`docker run`**: 「コンテナを作って起動せよ」という命令
2. **`-p 3000:3000`**: オプション（設定）
3. **`ddd-todo-api`**: 使うイメージ（設計図）の名前

---

### 各パーツの詳細解説

#### 1. `docker run` （起動命令）

これは実は2つの動作を一度に行っています。

* **Create:** イメージからコンテナ（箱）を作成する。
* **Start:** 作成したコンテナの中でプロセス（今回の場合は `node dist/main`）を実行する。

> **イメージとコンテナの違い**
> * **イメージ:** 料理のレシピ（読み取り専用）。
> * **コンテナ:** レシピを見て作った実際の料理（実際に食べられる/動くもの）。
> `docker run` は「レシピを見て料理を作って出す」ところまでやってくれます。
>
>

#### 2. `-p 3000:3000` （ポートフォワーディング）

ここが一番のつまずきポイントですが、**「穴をつなぐ」**とイメージしてください。

* **コンテナの中:** アプリは隔離された箱の中にいて、外（あなたのPC）からはアクセスできません。
* **このオプションの意味:** 「PCのポートと、コンテナのポートをパイプで繋ぐ」

```text
      PC (ホスト)         コンテナ (Docker)
    +-------------+      +-----------------+
    |             |      |                 |
    |  [ 3000 ] <==========> [ 3000 ]      |
    |  (入り口)   |      |  (NestJS)       |
    +-------------+      +-----------------+
       左側                 右側

```

* **左側 (3000):** あなたのブラウザがアクセスする番号 (`localhost:3000`)
* **右側 (3000):** コンテナの中でNestJSが待ち受けている番号 (`Dockerfile`のEXPOSEやコード内で指定したもの)

もし `-p 8080:3000` と書けば、ブラウザでは `localhost:8080` でアクセスできるようになります（コンテナの中は3000のままです）。

#### 3. `ddd-todo-api` （イメージ名）

「どの設計図を使うか」の指定です。さきほど `docker build -t ddd-todo-api .` で作った名前を指定します。

---

### 知っておくと便利な「他のオプション」

実務では、以下のようなオプションを追加して使うことが多いです。

#### 1. バックグラウンド実行 (`-d`)

今のままだと、ターミナルがログで埋め尽くされて、操作できなくなりますよね？
`-d` (detach) をつけると、裏側でひっそり動いてくれます。

```bash
docker run -d -p 3000:3000 ddd-todo-api

```

* 実行すると、長いIDだけが表示されてターミナルが入力を受け付ける状態に戻ります。

#### 2. 名前をつける (`--name`)

指定しないと `sleepy_shannon` 之ようなランダムな変な名前が勝手につけられます。
管理しやすくするために名前をつけます。

```bash
docker run --name my-nest-app -p 3000:3000 ddd-todo-api

```

#### 3. 終了時に自動削除 (`--rm`)

コンテナを停止（stop）しても、実はゴミとして残ります。
「ちょっと試して、終わったら綺麗に消したい」という時はこれをつけます。

```bash
docker run --rm -p 3000:3000 ddd-todo-api

```

---

### よく使う運用コマンドセット

アプリを動かし始めたら、セットで以下のコマンドも必要になります。

* **動いているコンテナを見る:**
```bash
docker ps

```


* **バックグラウンドのログを見る:**
```bash
# コンテナID または 名前を指定
docker logs -f <コンテナID>

```


(`-f` をつけるとリアルタイムでログが流れます。終了は `Ctrl + C`)
* **コンテナを止める:**
```bash
docker stop <コンテナID>

```



### まとめ

今のあなたのコマンド：
**「`ddd-todo-api` というレシピを使って料理（コンテナ）を作り、PCの3000番窓口とコンテナの3000番窓口を繋いで、起動してね」**

という意味になります！理解できましたでしょうか？